<SCRIPT LANGUAGE="JavaScript">
<!---
function minAndLastPass(minPasswordLength, lastPasswordUsed)
{
	//var testPassword = TRIM(document.ChgPassword.Password_1.value);

	//if(testPassword != '')
	//{
	//	var str = (testPassword);
	//	var regExp = ^[a-zA-Z]$;
	//	if(!regExp.test(str))
	//	{
	//		alert('No spaces or symbols are allowed in password')
	//		document.ChgPassword.Password_1.focus();
	//		return false;		
	//	}
	//}

	if(document.ChgPassword.Password_1.value == '')
	{
		alert('A value must be entered')
		document.ChgPassword.Password_1.focus();
		return false;
	}

	if(document.ChgPassword.Password_1.value.length < minPasswordLength)
	{
		alert('Password must meet the minimum length of ' + minPasswordLength + ' characters')
		document.ChgPassword.Password_1.focus();
		return false;
	}
	
	if(document.ChgPassword.Password_1.value == lastPasswordUsed)
	{
		alert('New password must be different than current password')
		document.ChgPassword.Password_1.focus();
		return false;
	}
}
function validatePasswords()
{
	if (document.ChgPassword.Password_1.value != document.ChgPassword.Password_2.value)
	{
		alert('Passwords must be the same');
		document.ChgPassword.Password_1.focus();
		return false;
	}
	else
	{
		
		SubmitForm();
		return true;
	}
}
function SubmitForm()
{
	document.ChgPassword.submit();
	alert('Your password has been changed successfully');
	window.close();

}
//--->
</SCRIPT>
<CENTER>
<FORM name="ChgPassword" ACTION="/scripts/mgrqispi.dll" METHOD="POST">
	<INPUT type="hidden" name="APPNAME"   value="<!$MG_App_Name>">
	<INPUT type="hidden" name="PRGNAME"   value="IMSSaveChangePassword">
	<INPUT type="hidden" name="ARGUMENTS" value="-N<!$MG_Session_Number>,-L<!$MG_Call_From_Login>">


<TABLE border="0" cellpadding="0" cellspacing="0" width="100%">
	<TR CLASS="bgbar">
		<TD CLASS="nnText" nowrap>&nbsp;Please enter your new password</TD>
	</TR>
</TABLE>


<BR>
<TABLE border="0" cellspacing="0" cellpadding="0" width="100%">
	<TR>
		<TD align="center" nowrap>
			<TABLE width="1%" border="0" cellspacing="0" cellpadding="0">
				<TR>
					<TD CLASS="bText" nowrap>Agent</TD>
					<TD nowrap>&nbsp;</TD>
					<TD CLASS="nnText" nowrap><!$MG_Member_Name></TD>
				</TR>
				<TR>
					<TD colspan=3>&nbsp;</TD>
				</TR>
				<TR>
					<TD CLASS="bText" nowrap>New Password</TD>
					<TD nowrap>&nbsp;</TD>
					<TD nowrap><INPUT CLASS="input" type="password" name="Password_1" onBlur="minAndLastPass(<!$MG_Password_Min>, <!$MG_Last_Password>)" size="12" maxlength="<!$MG_Password_Length>" value=""></TD>
				</TR>
				<TR>
					<TD CLASS="bText" nowrap>Confirm New Password&nbsp;&nbsp;</TD>
					<TD nowrap>&nbsp;</TD>
					<TD nowrap><INPUT CLASS="input" type="password" name="Password_2" size="12" maxlength="<!$MG_Password_Length>" value=""></TD>
				</TR>
				<TR>
					<TD colspan=3>&nbsp;</TD>
				</TR>
				<TR>
					<!-- If came from login, don't close the window after submitting - only close when coming from personal information -->
					<!$MGIF_CAME_FROM_LOGIN>
					<TD align="center" colspan="3" nowrap><INPUT type="submit" name="" value="Submit"></TD>
					<!$MGELSE>
					<TD align="center" colspan="3" nowrap><INPUT TYPE="Button" VALUE="Submit" onClick="validatePasswords()"></TD>
					<!$MGENDIF>
				</TR>
			</TABLE>
		</TD>
	</TR>
</TABLE>
</FORM>

<TABLE border="0" cellpadding="0" cellspacing="0" width="100%">
	<TR>
		<TD CLASS="bTextRed" align="center" nowrap>New Password must be the same as Confirm New Password</TD>
	</TR>
</TABLE>

<BR>
<TABLE border="0" cellpadding="0" cellspacing="0" width="100%">
	<TR>
		<TD CLASS="nnText" align="center" nowrap>Tip:  For security, avoid using your name, nickname, birth date,Social Security<BR> 											number or other commonly guessed items as a password.</TD>
	</TR>
</TABLE>


</CENTER>
<BR>