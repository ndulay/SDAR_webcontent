<SCRIPT LANGUAGE="JavaScript">
function CheckEmail()
{
	var Emailcheck = (document.Event.Email_Address.value);
	var str=(document.Event.Email_Address.value);
	
	if (Emailcheck == '')
	{
		alert('E-Mail Address is required');
		document.Event.Email_Address.focus();
		return false;
	}
	if (Emailcheck != '')
	{
		var reg1 = /(@.*@)|(\.\.)|(@\.)|(\.@)|(^\.)/;														 // not valid
		var reg2 = /^.+\@(\[?)[a-zA-Z0-9\-\.]+\.([a-zA-Z]{2,5}|[0-9]{1,5})(\]?)$/;		 // valid
		if (!reg1.test(str) && reg2.test(str))																 // if reg1 false and reg2 true (valid)
			{ 
			 return true;
			 }
		else
			{
			alert('Invalid E-Mail Address');
			document.Event.Email_Address.focus();
			return false;
			}
	}
}
	
</SCRIPT>
<TABLE>
	<TR>
		<TD>
			<FORM NAME="Event" action="/scripts/mgrqispi.dll" method="POST" onSubmit="return CheckEmail()">
			<INPUT type="hidden" name="APPNAME" value="<!$MG_App_Name>">
			<INPUT type="hidden" name="PRGNAME" value="IMSCancelRegistration">
			<INPUT type="hidden" name="ARGUMENTS" value="-N<!$MG_Session_Number>,-A1,-A<!$MG_Convention_ID>,-A<!$MG_Registration_ID>,-A<!$MG_Class_ID>,-N<!$MG_Receipt_ID>,-N<!$MG_Invoice_ID>,-A<!$MG_Cancellation_Mode>,-A<!$MG_Cancellation_Type>,-N<!$MG_Education_Card_Credit>">
			<INPUT type="hidden" name="Option" value="0">
			<INPUT type="hidden" name="Cancellation_Fee" value="<!$MG_PCancel_Fee>">
			<INPUT type="hidden" name="Charge_Code_Fee" value="<!$MG_PCharge_Code_Fee>">
		</TD>
	</TR>
</TABLE>

<TABLE border="0" width="100%" cellpadding="0" cellspacing="0">
	<TR>
		<TD nowrap>&nbsp;</TD>
	</TR>
	<!$MGIF_CLASS>
	<TR>
		<TD CLASS="bigTextMarine" align="left" nowrap><!$MG_Course_ID_Name></TD>
	</TR>
	<!$MGELSE>
	<TR>
		<TD CLASS="bigTextMarine" align="left" colspan="3" nowrap><!$MG_Event_Name></TD>
	</TR>
	<!$MGENDIF>
</TABLE>

<TABLE border="0" width="100%" cellpadding="0" cellspacing="1">
	<TR>
		<TD CLASS="bText" align="left" nowrap width="20%">Registration ID</TD>
		<TD CLASS="nnText" align="left" nowrap width="30%"><!$MG_Registration_ID></TD>
		<!$MGIF_INVOICE_FOUND>
			<TD CLASS="bText" align="left" nowrap width="20%">Invoice #</TD>
			<TD CLASS="nnText" align="left" nowrap width="30%"><!$MG_Invoice_#></TD>
		<!$MGELSE>
			<TD Colspan=2>&nbsp;</TD>
		<!$MGENDIF>
	</TR>
	<TR>
		<!$MGIF_CLASS>
		<TD CLASS="bText" align="left" nowrap width="20%">Class ID</TD>
		<!$MGELSE>
		<TD CLASS="bText" align="left" nowrap width="20%">Event ID</TD>
		<!$MGENDIF>
		<TD CLASS="nnText" align="left" nowrap width="30%"><!$MG_Class_ID></TD>
		<!$MGIF_INVOICE_FOUND>
			<TD CLASS="bText" align="left" nowrap width="20%">Invoice Date</TD>
			<TD CLASS="nnText" align="left" nowrap width="30%"><!$MG_Invoice_Date></TD>
		<!$MGELSE>
			<TD Colspan=2>&nbsp;</TD>
		<!$MGENDIF>

	</TR>
	<TR>
		<!$MGIF_CLASS>
		<TD CLASS="bText" align="Left" nowrap width="20%">Class Date</TD>
		<!$MGELSE>
		<TD CLASS="bText" align="Left" nowrap width="20%">Event Date</TD>
		<!$MGENDIF>
		<TD CLASS="nnText" align="Left" nowrap width="30%"><!$MG_Event_Date></TD>
		<!$MGIF_INVOICE_FOUND>
			<TD CLASS="bText" align="left" nowrap width="20%">Invoice Amount</TD>
			<TD CLASS="nnText" align="left" nowrap width="30%"><!$MG_Invoice_Amount></TD>
		<!$MGELSE>
			<TD Colspan=2>&nbsp;</TD>
		<!$MGENDIF>
	</TR>
	<TR>
		<TD Colspan=2>&nbsp;</TD>
		<!$MGIF_RECEIPT_FOUND>
		<TD CLASS="bText" align="left" nowrap width="20%">Receipt #</TD>
		<TD CLASS="nnText" align="left" nowrap width="30%"><!$MG_Receipt_#></TD>
		<!$MGELSE>
		<TD Colspan=2>&nbsp;</TD>
		<!$MGENDIF>

	</TR>
	<TR>
		<!$MGIF_CREDIT_FOUND>
			<TD CLASS="bText" align="Left" nowrap width="20%">Credit(s) refunded</TD>
			<TD CLASS="nnText" align="Left" nowrap width="30%"><!$MG_Credits></TD>
		<!$MGELSE>
			<TD CLASS="bText" align="Left" nowrap width="20%">Registration Amount</TD>
			<TD CLASS="nnText" align="Left" nowrap width="30%"><!$MG_Amount></TD>
		<!$MGENDIF>
		<!$MGIF_RECEIPT_FOUND>
		<TD CLASS="bText" align="left" nowrap width="20%">Receipt Amount</TD>
		<TD CLASS="nnText" align="left" nowrap width="30%"><!$MG_Receipt_Amount></TD>
		<!$MGELSE>
		<TD Colspan=2>&nbsp;</TD>
		<!$MGENDIF>
	</TR>
	<!$MGIF_CANCEL_FEE_FOUND>
	<TR>
		<TD CLASS="bText" align="Left" nowrap width="20%">Cancellation Fee</TD>
		<TD CLASS="nnText" align="Left" nowrap width="30%"><!$MG_Cancel_Fee></TD>
		<TD Colspan=2>&nbsp;</TD>
	</TR>
	<!$MGENDIF>
	<TR>
		<TD Colspan=4>&nbsp;</TD>
	</TR>
	<!$MGIF_INVOICE_FOUND>
		<TR>
			<TD CLASS="bText" align="Left" nowrap width="20%">Total&nbsp;<!$MG_Charge_or_Credit></TD>
			<TD CLASS="bTextRed" align="Left" nowrap width="30%"><!$MG_Refund_Amt></TD>
			<TD Colspan=2>&nbsp;</TD>
		</TR>
		<TR>
			<TD Colspan=4>&nbsp;</TD>
		</TR>
	<!$MGENDIF>
	<TR>
		<!$MGIF_MODIFY_EMAIL>
			<TD CLASS="bTextMarine" nowrap>E-Mail Address<FONT size="1" color="red"> (required)</FONT></TD>
			<TD nowrap colspan=3><INPUT CLASS="input" type="text" name="Email_Address" size="50" maxlength="80"
			value="<!$MG_EMail_Address>"></TD>
		<!$MGELSE>
			<TD CLASS="bTextMarine"colspan=4 nowrap>
				<INPUT type="hidden" name="Email_Address" value="<!$MG_EMail_Address>"> <color="black">E-Mail Address</FONT>&nbsp;&nbsp;&nbsp;<!$MG_EMail_Address>
			</TD>
		<!$MGENDIF>
	</TR>
	<TR>
		<TD Colspan=4>&nbsp;</TD>
	</TR>
	<TR>
		<TD Colspan=2 Align="Right"><INPUT TYPE="Submit" Value="Submit Cancellation"></TD>
		<TD Colspan=2 Align="Left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<INPUT TYPE="button" VALUE="Previous Screen" onClick="history.go(-1)"></TD>
	</TR>
</TABLE>
<BR>

</FORM>